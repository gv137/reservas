<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="styleForms.css">
    <title>Reservar</title>
</head>

<body>

    <button onclick="voltarPagina()" class="voltar">
        &#8592;
    </button>
    

    <h1>Formulário de Reserva</h1>

    <br><br><br>

    
        <form id="formReserva" method="POST" name="google-sheet">
            <div class="form-container">

                <div class="form-group"> 
                    <b><label for="item">Item:</label></b><br>
                    <input type="text" id="item" name="item" readonly>
                </div> 

                <br><br>

                <div class="form-group"> 
                    <b><label for="data">Data de Reserva:</label></b><br>
                    <input type="date" id="data" name="data" required>
                </div>    
                
                <br><br>

                <div class="form-group"> 
                    <b><label for="data">Horário inicial</label></b><br>
                    <input type="time" id="time_inicio" name="time_inicio" required>
                </div>    
                
                <br><br>

                <div class="form-group"> 
                    <b><label for="data">Horário devolução</label></b><br>
                    <input type="time" id="time_final" name="time_final" required>
                </div>    
                
                <br><br>

                <div class="form-group"> 
                    <b><label for="quantidade">Quantidade:</label></b><br>
                    <input type="number" id="quantidade" name="quantidade" min="1" max="3" required>
                </div>

                <br><br>

                <div class="form-group">    
                    <b><label for="nome">Nome do Responsável:</label></b><br>
                    <input type="text" id="nome" name="nome" required>
                </div>

                <br><br>

                <button type="submit">Enviar Reserva</button>

            </div>
        </form>
   
        <p id="mensagem"></p>

    <script>
        // Preencher o campo "Item" com o valor da URL
        const params = new URLSearchParams(window.location.search);
        const item = params.get('item');
        if (item) {
            document.getElementById('item').value = item;
        }

        function voltarPagina() {
            window.history.back();
        }

        const form = document.getElementById("formReserva");
        const mensagem = document.getElementById("mensagem");

        form.addEventListener("submit", function (e) {
            e.preventDefault(); // Evita o reload da página
        });



        // direcionameto dos dados para a planilha 

        const scriptURL = 'https://script.google.com/macros/s/AKfycbwEdNaT74l5cRInlYWt8BOtLBbsO6Bq_gRTgdrYWlPZG9QihhUohUOuILjUTAR-e4V9Ew/exec'
        const forms = document.forms ['google-sheet']

        forms.addEventListener('submit', e => {e.preventDefault () 
            fetch(scriptURL, {method: 'POST', body: new FormData(forms)}) 
            .then(response => alert("Item reservado")) 
            .catch(error => console.error('Error:', error))})

    </script>
</body>
</html>
